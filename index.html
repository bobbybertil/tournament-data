<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maharashtra Youth League Tournament</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            min-height: 100vh;
            padding: 10px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { 
            background: white; 
            border-radius: 12px; 
            padding: 20px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
            margin-bottom: 15px; 
        }
        .header h1 { 
            color: #1e40af; 
            font-size: 1.5em; 
            margin-bottom: 10px;
        }
        .subtitle { color: #64748b; font-size: 0.9em; margin-top: 5px; }
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8fafc;
            padding: 10px 15px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 13px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .status-online { color: #10b981; font-weight: 600; }
        .status-offline { color: #ef4444; font-weight: 600; }
        .admin-mode {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            padding: 12px 15px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .alert {
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        .alert-info { background: #dbeafe; border: 2px solid #3b82f6; color: #1e40af; }
        .alert-success { background: #d1fae5; border: 2px solid #10b981; color: #065f46; }
        .alert-error { background: #fee2e2; border: 2px solid #ef4444; color: #991b1b; }
        .alert-warning { background: #fef3c7; border: 2px solid #f59e0b; color: #92400e; }
        .tabs { display: flex; gap: 8px; margin-bottom: 15px; }
        .tab-btn { 
            flex: 1; 
            padding: 12px 15px; 
            background: white; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 14px; 
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .tab-btn.active { background: #3b82f6; color: white; }
        .content { 
            background: white; 
            border-radius: 12px; 
            padding: 20px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
        }
        .match-card { 
            border: 2px solid #e2e8f0; 
            border-radius: 8px; 
            padding: 15px; 
            margin-bottom: 12px;
        }
        .match-completed { background: #f0fdf4; border-color: #86efac; }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
        }
        .btn-primary { background: #3b82f6; color: white; }
        .btn-success { background: #10b981; color: white; }
        .btn-warning { background: #f59e0b; color: white; }
        .save-btn { 
            width: 100%; 
            padding: 12px; 
            background: #10b981; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-weight: 600; 
            margin-top: 10px;
        }
        .save-btn:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }
        .hidden { display: none; }
        .loading { text-align: center; padding: 30px; color: #64748b; }
        .config-form {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #78350f;
            font-size: 14px;
        }
        .input-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #fbbf24;
            border-radius: 6px;
            font-size: 14px;
        }
        @media (min-width: 768px) {
            .header h1 { font-size: 2em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="alertContainer"></div>
        
        <div class="header">
            <h1>üèÜ Maharashtra Youth League</h1>
            <p class="subtitle">Junior Boys Championship 2025-26</p>
            <p class="subtitle">üåê Public Tournament Tracker</p>
            <div class="status-bar">
                <span id="statusIndicator" class="status-offline">‚ö´ Loading...</span>
                <span id="lastSync" style="color: #64748b;">Checking for updates...</span>
                <button onclick="loadFromGitHub()" class="btn btn-primary" style="padding: 6px 12px; font-size: 12px;">üîÑ Refresh</button>
            </div>
            <div id="adminMode" class="admin-mode hidden">
                <span style="color: #92400e; font-weight: 600;">üîë Admin Mode Active</span>
                <button onclick="logout()" class="btn btn-warning" style="padding: 6px 12px; font-size: 12px;">Logout</button>
            </div>
        </div>

        <!-- Admin Configuration (Show only if not configured) -->
        <div id="configSection" class="config-form hidden">
            <h3 style="color: #92400e; margin-bottom: 10px;">üîê Admin Login</h3>
            <p style="color: #78350f; font-size: 13px; margin-bottom: 15px;">
                Configure your GitHub credentials to enable admin features
            </p>
            
            <div class="input-group">
                <label>Your GitHub Username:</label>
                <input type="text" id="githubUsername" placeholder="your-username">
            </div>
            
            <div class="input-group">
                <label>Repository Name:</label>
                <input type="text" id="githubRepo" placeholder="tournament-data" value="tournament-data">
            </div>
            
            <div class="input-group">
                <label>File Name:</label>
                <input type="text" id="githubFile" placeholder="tournament-data.json" value="tournament-data.json">
            </div>
            
            <div class="input-group">
                <label>Personal Access Token (for editing):</label>
                <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxxx">
            </div>
            
            <button onclick="saveAdminConfig()" class="btn btn-success" style="width: 100%;">
                üîì Login as Admin
            </button>
            
            <button onclick="closeConfig()" class="btn" style="width: 100%; margin-top: 10px; background: #94a3b8; color: white;">
                Cancel (View Only)
            </button>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('schedule')">üìÖ Schedule</button>
            <button class="tab-btn" onclick="switchTab('standings')">üìä Table</button>
            <button class="tab-btn" onclick="switchTab('settings')">‚öôÔ∏è Settings</button>
        </div>

        <div class="content">
            <!-- SCHEDULE TAB -->
            <div id="scheduleTab">
                <div style="margin-bottom: 15px;">
                    <select id="dateFilter" onchange="filterMatches()" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 6px;">
                        <option value="all">All Dates</option>
                    </select>
                </div>
                <div id="matchesList">
                    <div class="loading">Loading matches from GitHub...</div>
                </div>
            </div>

            <!-- STANDINGS TAB -->
            <div id="standingsTab" class="hidden">
                <h2 style="color: #1e40af; margin-bottom: 15px;">League Standings</h2>
                <div id="statsCards"></div>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <thead>
                            <tr style="background: #f8fafc; border-bottom: 2px solid #e2e8f0;">
                                <th style="padding: 12px; text-align: left;">#</th>
                                <th style="padding: 12px; text-align: left;">Team</th>
                                <th style="padding: 12px; text-align: center;">P</th>
                                <th style="padding: 12px; text-align: center;">W</th>
                                <th style="padding: 12px; text-align: center;">D</th>
                                <th style="padding: 12px; text-align: center;">L</th>
                                <th style="padding: 12px; text-align: center;">GF</th>
                                <th style="padding: 12px; text-align: center;">GA</th>
                                <th style="padding: 12px; text-align: center;">GD</th>
                                <th style="padding: 12px; text-align: center;">Pts</th>
                            </tr>
                        </thead>
                        <tbody id="standingsBody">
                            <tr><td colspan="10" class="loading">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SETTINGS TAB -->
            <div id="settingsTab" class="hidden">
                <h2 style="color: #1e40af; margin-bottom: 15px;">Settings</h2>
                
                <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin-bottom: 15px; border: 2px solid #e2e8f0;">
                    <h3 style="margin-bottom: 15px;">üìä Statistics</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px;">
                        <div style="background: white; padding: 15px; border-radius: 6px; text-align: center; border: 2px solid #e2e8f0;">
                            <div id="totalCount" style="font-size: 24px; font-weight: bold; color: #3b82f6;">0</div>
                            <div style="font-size: 12px; color: #64748b;">Total</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 6px; text-align: center; border: 2px solid #e2e8f0;">
                            <div id="completedCount" style="font-size: 24px; font-weight: bold; color: #10b981;">0</div>
                            <div style="font-size: 12px; color: #64748b;">Completed</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 6px; text-align: center; border: 2px solid #e2e8f0;">
                            <div id="pendingCount" style="font-size: 24px; font-weight: bold; color: #f59e0b;">0</div>
                            <div style="font-size: 12px; color: #64748b;">Pending</div>
                        </div>
                    </div>
                </div>

                <div style="background: #dbeafe; padding: 20px; border-radius: 8px; margin-bottom: 15px; border: 2px solid #3b82f6;">
                    <h3 style="color: #1e40af; margin-bottom: 15px;">üîê Admin Access</h3>
                    <p style="color: #1e3a8a; font-size: 13px; margin-bottom: 15px;">
                        Login as admin to edit match results
                    </p>
                    <button onclick="showAdminLogin()" class="btn btn-primary">
                        üîë Admin Login
                    </button>
                </div>

                <div style="background: #f3e8ff; padding: 20px; border-radius: 8px; margin-bottom: 15px; border: 2px solid #a855f7;">
                    <h3 style="color: #6b21a8; margin-bottom: 10px;">üåê Share This Tournament</h3>
                    <p style="color: #7e22ce; font-size: 13px; margin-bottom: 15px;">
                        Share this URL with anyone to view the tournament
                    </p>
                    <div style="background: white; padding: 15px; border-radius: 6px; word-break: break-all; font-family: monospace; font-size: 12px; margin-bottom: 10px;" id="shareUrl"></div>
                    <button onclick="copyShareUrl()" class="btn btn-success">üìã Copy URL</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let allMatches = [];
        let config = {
            username: '',
            repo: '',
            file: '',
            token: '',
            branch: 'main'
        };
        let lastSHA = null;
        let isAdmin = false;
        let autoRefreshInterval = null;

        // IMPORTANT: Change these to YOUR GitHub username and repo!
        const DEFAULT_CONFIG = {
            username: 'YOUR_GITHUB_USERNAME',  // ‚Üê CHANGE THIS
            repo: 'tournament-data',           // ‚Üê Repository name
            file: 'tournament-data.json',      // ‚Üê Data file name
            branch: 'main'
        };

        // Load data from GitHub (public access)
        async function loadFromGitHub() {
            try {
                updateStatusIndicator(false, 'Loading...');
                
                // Use config if admin, otherwise use default
                const useConfig = isAdmin ? config : DEFAULT_CONFIG;
                const rawUrl = `https://raw.githubusercontent.com/${useConfig.username}/${useConfig.repo}/${useConfig.branch}/${useConfig.file}`;
                
                const response = await fetch(rawUrl, {
                    cache: 'no-cache',
                    headers: { 'Cache-Control': 'no-cache' }
                });

                if (!response.ok) {
                    throw new Error('Failed to load data');
                }

                const data = await response.json();
                allMatches = data.matches || [];
                
                // Get SHA if admin
                if (isAdmin && config.token) {
                    await getSHA();
                }

                updateStatusIndicator(true);
                updateLastSync();
                refreshUI();
            } catch (error) {
                updateStatusIndicator(false, 'Error');
                showAlert('Error loading: ' + error.message, 'error');
            }
        }

        // Get file SHA (needed for updates)
        async function getSHA() {
            try {
                const apiUrl = `https://api.github.com/repos/${config.username}/${config.repo}/contents/${config.file}`;
                const response = await fetch(apiUrl, {
                    headers: config.token ? {
                        'Authorization': `token ${config.token}`
                    } : {}
                });
                const data = await response.json();
                lastSHA = data.sha;
            } catch (error) {
                console.error('Error getting SHA:', error);
            }
        }

        // Save data to GitHub (admin only)
        async function saveToGitHub() {
            if (!isAdmin || !config.token) {
                showAlert('Admin login required to save changes', 'error');
                return false;
            }

            try {
                const apiUrl = `https://api.github.com/repos/${config.username}/${config.repo}/contents/${config.file}`;
                const content = btoa(unescape(encodeURIComponent(JSON.stringify({ matches: allMatches }, null, 2))));
                
                const body = {
                    message: 'Update tournament data - ' + new Date().toLocaleString(),
                    content: content,
                    branch: config.branch
                };

                if (lastSHA) {
                    body.sha = lastSHA;
                }

                const response = await fetch(apiUrl, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${config.token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(body)
                });

                if (!response.ok) {
                    throw new Error('Failed to save');
                }

                const data = await response.json();
                lastSHA = data.content.sha;
                updateLastSync();
                return true;
            } catch (error) {
                console.error('Error saving:', error);
                showAlert('Error saving: ' + error.message, 'error');
                return false;
            }
        }

        // Admin configuration
        function showAdminLogin() {
            document.getElementById('configSection').classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function closeConfig() {
            document.getElementById('configSection').classList.add('hidden');
        }

        function saveAdminConfig() {
            config.username = document.getElementById('githubUsername').value.trim();
            config.repo = document.getElementById('githubRepo').value.trim();
            config.file = document.getElementById('githubFile').value.trim();
            config.token = document.getElementById('githubToken').value.trim();
            config.branch = 'main';

            if (!config.username || !config.repo || !config.file || !config.token) {
                showAlert('Please fill in all fields', 'error');
                return;
            }

            isAdmin = true;
            localStorage.setItem('adminConfig', JSON.stringify(config));
            document.getElementById('configSection').classList.add('hidden');
            document.getElementById('adminMode').classList.remove('hidden');
            
            showAlert('‚úì Logged in as admin!', 'success');
            loadFromGitHub();
        }

        function logout() {
            if (confirm('Logout from admin mode?')) {
                isAdmin = false;
                config = { username: '', repo: '', file: '', token: '', branch: 'main' };
                localStorage.removeItem('adminConfig');
                document.getElementById('adminMode').classList.add('hidden');
                showAlert('Logged out. Switched to view-only mode.', 'info');
                loadFromGitHub();
            }
        }

        // Check if previously logged in as admin
        function checkAdminSession() {
            const saved = localStorage.getItem('adminConfig');
            if (saved) {
                config = JSON.parse(saved);
                isAdmin = true;
                document.getElementById('adminMode').classList.remove('hidden');
            }
        }

        // Save match result
        async function saveResult(matchId) {
            if (!isAdmin) {
                showAlert('Admin login required to edit matches', 'error');
                showAdminLogin();
                return;
            }

            const scoreA = parseInt(document.getElementById(`scoreA-${matchId}`).value);
            const scoreB = parseInt(document.getElementById(`scoreB-${matchId}`).value);

            if (isNaN(scoreA) || isNaN(scoreB) || scoreA < 0 || scoreB < 0) {
                showAlert('Please enter valid scores', 'error');
                return;
            }

            allMatches = allMatches.map(m => {
                if (m.id === matchId) {
                    return { ...m, scoreA, scoreB, status: 'COMPLETED' };
                }
                return m;
            });

            const saved = await saveToGitHub();
            if (saved) {
                showAlert('‚úì Result saved! Live for everyone.', 'success');
                filterMatches();
            }
        }

        // UI Helpers
        function updateStatusIndicator(online, message = null) {
            const indicator = document.getElementById('statusIndicator');
            if (message) {
                indicator.textContent = '‚ö´ ' + message;
                indicator.className = 'status-offline';
            } else if (online) {
                indicator.textContent = 'üü¢ Live Data';
                indicator.className = 'status-online';
            } else {
                indicator.textContent = 'üî¥ Offline';
                indicator.className = 'status-offline';
            }
        }

        function updateLastSync() {
            const now = new Date().toLocaleString();
            document.getElementById('lastSync').textContent = 'Updated: ' + now;
        }

        function showAlert(message, type = 'info') {
            const container = document.getElementById('alertContainer');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            container.appendChild(alert);
            setTimeout(() => alert.remove(), 4000);
        }

        function copyShareUrl() {
            const url = window.location.href;
            const temp = document.createElement('textarea');
            temp.value = url;
            document.body.appendChild(temp);
            temp.select();
            document.execCommand('copy');
            document.body.removeChild(temp);
            showAlert('‚úì URL copied! Share it with everyone.', 'success');
        }

        // Display functions
        function displayMatches(matches) {
            const container = document.getElementById('matchesList');
            if (matches.length === 0) {
                container.innerHTML = '<p class="loading">No matches found</p>';
                return;
            }

            container.innerHTML = matches.map(match => {
                const isCompleted = match.status === 'COMPLETED';
                const canEdit = isAdmin && !isCompleted;
                
                return `
                    <div class="match-card ${isCompleted ? 'match-completed' : ''}">
                        <div style="color: #64748b; font-size: 12px; margin-bottom: 10px;">
                            üìÖ ${match.matchDate} | ‚è∞ ${match.matchTime} | üèüÔ∏è Ground ${match.ground}
                        </div>
                        ${isCompleted ? `
                            <div style="text-align: center;">
                                <div style="font-weight: 600; margin: 8px 0;">${match.teamA}</div>
                                <div style="font-size: 28px; font-weight: bold; color: #10b981; margin: 10px 0;">
                                    ${match.scoreA} - ${match.scoreB}
                                </div>
                                <div style="font-weight: 600; margin: 8px 0;">${match.teamB}</div>
                                <div style="color: #10b981; font-weight: 600; margin-top: 10px;">‚úì Completed</div>
                            </div>
                        ` : canEdit ? `
                            <div style="margin: 15px 0;">
                                <div style="font-weight: 600; margin-bottom: 5px;">${match.teamA}</div>
                                <input type="number" id="scoreA-${match.id}" min="0" placeholder="0" 
                                       style="width: 80px; padding: 8px; border: 2px solid #e2e8f0; border-radius: 6px; margin-bottom: 10px;">
                                
                                <div style="font-weight: 600; margin-bottom: 5px;">${match.teamB}</div>
                                <input type="number" id="scoreB-${match.id}" min="0" placeholder="0" 
                                       style="width: 80px; padding: 8px; border: 2px solid #e2e8f0; border-radius: 6px;">
                            </div>
                            <button onclick="saveResult(${match.id})" class="save-btn">üíæ Save Result</button>
                        ` : `
                            <div style="text-align: center; padding: 15px;">
                                <div style="font-weight: 600; margin-bottom: 5px;">${match.teamA}</div>
                                <div style="font-size: 24px; color: #64748b; margin: 10px 0;">VS</div>
                                <div style="font-weight: 600;">${match.teamB}</div>
                                <div style="color: #64748b; font-size: 13px; margin-top: 10px;">Match not yet played</div>
                            </div>
                        `}
                    </div>
                `;
            }).join('');
        }

        function calculateStandings() {
            const teams = {};
            
            allMatches.filter(m => m.status === 'COMPLETED').forEach(match => {
                if (!teams[match.teamA]) {
                    teams[match.teamA] = {name: match.teamA, played: 0, won: 0, drawn: 0, lost: 0, gf: 0, ga: 0, gd: 0, points: 0};
                }
                if (!teams[match.teamB]) {
                    teams[match.teamB] = {name: match.teamB, played: 0, won: 0, drawn: 0, lost: 0, gf: 0, ga: 0, gd: 0, points: 0};
                }

                teams[match.teamA].played++;
                teams[match.teamB].played++;
                teams[match.teamA].gf += match.scoreA;
                teams[match.teamA].ga += match.scoreB;
                teams[match.teamB].gf += match.scoreB;
                teams[match.teamB].ga += match.scoreA;

                if (match.scoreA > match.scoreB) {
                    teams[match.teamA].won++;
                    teams[match.teamA].points += 3;
                    teams[match.teamB].lost++;
                } else if (match.scoreB > match.scoreA) {
                    teams[match.teamB].won++;
                    teams[match.teamB].points += 3;
                    teams[match.teamA].lost++;
                } else {
                    teams[match.teamA].drawn++;
                    teams[match.teamB].drawn++;
                    teams[match.teamA].points += 1;
                    teams[match.teamB].points += 1;
                }

                teams[match.teamA].gd = teams[match.teamA].gf - teams[match.teamA].ga;
                teams[match.teamB].gd = teams[match.teamB].gf - teams[match.teamB].ga;
            });

            return Object.values(teams).sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                if (b.gd !== a.gd) return b.gd - a.gd;
                return b.gf - a.gf;
            });
        }

        function displayStandings() {
            const standings = calculateStandings();
            const tbody = document.getElementById('standingsBody');
            
            if (standings.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" class="loading">No results yet</td></tr>';
                document.getElementById('statsCards').innerHTML = '';
                return;
            }

            const totalMatches = allMatches.filter(m => m.status === 'COMPLETED').length;
            const totalGoals = standings.reduce((sum, team) => sum + team.gf, 0);
            const avgGoals = totalMatches > 0 ? (totalGoals / totalMatches).toFixed(1) : 0;
            
            document.getElementById('statsCards').innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 20px;">
                    <div style="background: #f8fafc; padding: 15px; border-radius: 6px; border: 2px solid #e2e8f0; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #3b82f6;">${standings.length}</div>
                        <div style="font-size: 12px; color: #64748b;">Teams</div>
                    </div>
                    <div style="background: #f8fafc; padding: 15px; border-radius: 6px; border: 2px solid #e2e8f0; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #3b82f6;">${totalMatches}</div>
                        <div style="font-size: 12px; color: #64748b;">Matches</div>
                    </div>
                    <div style="background: #f8fafc; padding: 15px; border-radius: 6px; border: 2px solid #e2e8f0; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #3b82f6;">${totalGoals}</div>
                        <div style="font-size: 12px; color: #64748b;">Goals</div>
                    </div>
                    <div style="background: #f8fafc; padding: 15px; border-radius: 6px; border: 2px solid #e2e8f0; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #3b82f6;">${avgGoals}</div>
                        <div style="font-size: 12px; color: #64748b;">Avg/Match</div>
                    </div>
                </div>
            `;

            tbody.innerHTML = standings.map((team, index) => `
                <tr style="${index < 3 ? 'background: #fef3c7;' : ''} border-bottom: 1px solid #f1f5f9;">
                    <td style="padding: 12px; font-weight: bold; color: #3b82f6;">${index + 1}</td>
                    <td style="padding: 12px;"><strong>${team.name}</strong></td>
                    <td style="padding: 12px; text-align: center;">${team.played}</td>
                    <td style="padding: 12px; text-align: center;">${team.won}</td>
                    <td style="padding: 12px; text-align: center;">${team.drawn}</td>
                    <td style="padding: 12px; text-align: center;">${team.lost}</td>
                    <td style="padding: 12px; text-align: center;">${team.gf}</td>
                    <td style="padding: 12px; text-align: center;">${team.ga}</td>
                    <td style="padding: 12px; text-align: center; font-weight: bold; color: ${team.gd >= 0 ? '#10b981' : '#ef4444'}">${team.gd > 0 ? '+' : ''}${team.gd}</td>
                    <td style="padding: 12px; text-align: center; font-weight: bold; font-size: 16px; color: #3b82f6;">${team.points}</td>
                </tr>
            `).join('');
        }

        function displaySettings() {
            const total = allMatches.length;
            const completed = allMatches.filter(m => m.status === 'COMPLETED').length;
            
            document.getElementById('totalCount').textContent = total;
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('pendingCount').textContent = total - completed;
            document.getElementById('shareUrl').textContent = window.location.href;
        }

        function filterMatches() {
            const selectedDate = document.getElementById('dateFilter').value;
            const filtered = selectedDate === 'all' 
                ? allMatches 
                : allMatches.filter(m => m.matchDate === selectedDate);
            displayMatches(filtered);
        }

        function populateDateFilter() {
            const dates = [...new Set(allMatches.map(m => m.matchDate))];
            const sortedDates = dates.sort((a, b) => {
                const [dayA, monthA, yearA] = a.split('/').map(Number);
                const [dayB, monthB, yearB] = b.split('/').map(Number);
                return new Date(yearA, monthA - 1, dayA) - new Date(yearB, monthB - 1, dayB);
            });
            
            const select = document.getElementById('dateFilter');
            select.innerHTML = '<option value="all">All Dates (' + allMatches.length + ')</option>';
            sortedDates.forEach(date => {
                const count = allMatches.filter(m => m.matchDate === date).length;
                select.innerHTML += `<option value="${date}">${date} (${count})</option>`;
            });
        }

        function refreshUI() {
            populateDateFilter();
            filterMatches();
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            document.getElementById('scheduleTab').classList.add('hidden');
            document.getElementById('standingsTab').classList.add('hidden');
            document.getElementById('settingsTab').classList.add('hidden');

            if (tab === 'schedule') {
                document.getElementById('scheduleTab').classList.remove('hidden');
                refreshUI();
            } else if (tab === 'standings') {
                document.getElementById('standingsTab').classList.remove('hidden');
                displayStandings();
            } else if (tab === 'settings') {
                document.getElementById('settingsTab').classList.remove('hidden');
                displaySettings();
            }
        }

        // Auto-refresh every 30 seconds
        function startAutoRefresh() {
            autoRefreshInterval = setInterval(() => {
                loadFromGitHub();
            }, 30000); // 30 seconds
        }

        // Initialize
        window.onload = () => {
            checkAdminSession();
            loadFromGitHub();
            startAutoRefresh();
            
            if (!isAdmin) {
                showAlert('üëÄ Viewing mode. Data updates every 30 seconds.', 'info');
            }
        };
    </script>
</body>
</html>
